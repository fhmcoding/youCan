
<!DOCTYPE html>
<html lang="en"  >
    <head>
        <meta charset="utf-8"/>

        
        <title>veyare | </title>

        
        <meta name="description" content=""/>
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/>
        <meta name="csrf-token" content="40YlPKQlIdDXJQi92Btb04uplPWixE35hy8YfiR5">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css" integrity="sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l" crossorigin="anonymous">
        <link href="https://unpkg.com/filepond/dist/filepond.css" rel="stylesheet" />
        <link href="https://unpkg.com/filepond-plugin-image-preview/dist/filepond-plugin-image-preview.css" rel="stylesheet">


    <style>
        .border-3 {
            border-width: 3px !important;
        }
        .ti-input{
            border: 1px solid #e4e6ef !important;
        }
        .bootstrap-tagsinput .badge {
            margin-right: 2px !important;
        }
        .filepond--credits{display:none;}
        .filepond--item {
            width: calc(50% - .5em);
        }
        @media (min-width: 30em) {
            .filepond--item {
                width: calc(50% - .5em);
            }
        }
        @media (min-width: 50em) {
            .filepond--item {
                width: calc(33.33% - .5em);
            }
        }
        .filepond--root {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto,
            Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji',
            'Segoe UI Symbol';
        }
        /* use a hand cursor intead of arrow for the action buttons */
        .filepond--file-action-button {
            cursor: pointer;
        }
        /* the text color of the drop label*/
        .filepond--drop-label {
            color: #555;
        }
        /* underline color for "Browse" button */
        .filepond--label-action {
            text-decoration-color: #aaa;
        }
        /* the background color of the filepond drop area */
        .filepond--panel-root {
            background-color: #eee;
        }
        /* the border radius of the drop area */
        .filepond--panel-root {
            border-radius: 0.5em;
        }
        /* the border radius of the file item */
        .filepond--item-panel {
            border-radius: 0.5em;
        }
        /* the background color of the file and file panel (used when dropping an image) */
        .filepond--item-panel {
            background-color: #555;
        }
        /* the background color of the drop circle */
        .filepond--drip-blob {
            background-color: #999;
        }
        /* the background color of the black action buttons */
        .filepond--file-action-button {
            background-color: rgba(0, 0, 0, 0.5);
        }
        /* the icon color of the black action buttons */
        .filepond--file-action-button {
            color: white;
        }
        /* the color of the focus ring */
        .filepond--file-action-button:hover,
        .filepond--file-action-button:focus {
            box-shadow: 0 0 0 0.125em rgba(255, 255, 255, 0.9);
        }
        /* the text color of the file status and info labels */
        .filepond--file {
            color: white;
        }
        /* error state color */
        [data-filepond-item-state*='error'] .filepond--item-panel,
        [data-filepond-item-state*='invalid'] .filepond--item-panel {
            background-color: red;
        }
        [data-filepond-item-state='processing-complete'] .filepond--item-panel {
            background-color: green;
        }
        /* bordered drop area */
        .filepond--panel-root {
            background-color: transparent;
            border: 2px solid #ddd;
        }
        /* .filepond--root {
            max-height: 10em;
        } */
        .alert_container{
            position:fixed;
            bottom:0px;
            right:-20px;
            margin:25px;
        }
        .alert.alert-custom.alert-success {
            background-color: #00c853 !important;
            border-color: #00c853 !important;
        }
        .alert.alert-custom {
            padding: .2rem 1rem !important;
        }
    </style>
    </head>

    <body>

        <form action="{{ route('admin.submit.product') }}" method="post"  enctype="multipart/form-data" id="myFormId" class="container my-3">
       
        <div class="row">

            <div class="col-xl-8 col-12 mb-3">
                <div class="card card-custom card-stretch gutter-b">
                    <div class="card-header border-0">
                        <h3 class="card-title font-weight-bolder text-dark"> New Product </h3>
                    </div>
                    <div class="card-body pt-2">
                        <div class="row">
                            <div class="col-12 col-xl-12 mb-3">
                                <div class="form-group">
                                    <label for="name">Name <span class="text-danger">*</span></label>
                                    <input type="text" name="name"  required  class="form-control w-full  " placeholder="Name">
                                </div>
                            </div>
                            <div class="col-12 col-xl-12 mb-3">
                                <div class="form-group">
                                    <label for="description">Description  <span class="text-danger">*</span></label>
                                    <textarea name="description" required  id="mytextarea" class=""></textarea>
                                </div>
                            </div>

                            <div class="col-12 col-xl-6 col-md-6 mb-3">
                                <div class="form-group">
                                    <label for="price">Price<span class="text-danger">*</span> </label>
                                    <input type="number"  required  name="price" class="form-control " id="price" placeholder="00.00">
                                </div>
                            </div>
                            <div class="col-12 col-xl-6 col-md-6 mb-3">
                                <div class="form-group">
                                    <label for="oldprice">Old Price  </label>
                                    <input type="number" name="oldprice" class="form-control " id="oldprice" placeholder="00.00">
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
            <div class="col-xl-4 col-12 ">
                <div class="card card-custom  gutter-b" style="position: sticky !important;top: 140px;">
                    <div class="card-body pt-2">
                        <div class="form-group mt-2">
                            <label for="kt" class="mb-2">Choose a category<span class="text-danger"> *</span> </label>
                            <select id="category"  required  class="form-control selectpicker " id="kt" name="categore_father_id">
                                <option>-----Choose a category----</option>
                                
                            </select>
                        </div>
                        <div class="form-group mt-2">
                            <label for="ktuu" class="mb-2">Select a subcategory </label>
                            <select class="form-control subcategore"  id="ktuu" name="subcategory">

                            </select>
                        </div>
                        <div class="form-group mt-2">
                            <label for="kt2" class="mb-2">Select status<span class="text-danger"> *</span> </label>
                            <select class="form-control selectpicker" required  id="kt2" name="statu">
                                <option value="active">active</option>
                                <option value="pending">pending </option>
                            </select>
                        </div>
                        <div class="form-group mt-2">
                            <label for="kt" class="mb-2">Offer</label>
                            <input type="text" class="form-control" id="offer" placeholder="Offer" name="offer">
                        </div>
                        <div class="form-group mt-2">
                            <label for="kt" class="mb-2"> Qty  </label>
                            <input type="number" class="form-control" id="qty" placeholder="qty" name="qty">
                        </div>

                        <button type="button"  onclick='sendRequest()' class="btn btn-success btn-block"> publier </button>
                    </div>
                </div>
            </div>
            <div class="col-xl-8 col-12 mb-3">
                <div class="card card-custom card-stretch gutter-b">
                    <div class="card-header border-0">
                        <h3 class="card-title font-weight-bolder text-dark">  Product Images</h3>
                    </div>
                    <div class="card-body pt-2">
                        <div id="images_container">
                            <input type="file"  class="filepond" name="images" multiple  data-allow-reorder="true" data-max-file-size="3MB" >
                        </div>
                    </div>
                </div>
            </div>
            <div id="vue-app" class="col-xl-8 col-12 mb-3">
                <div class="card card-custom card-stretch gutter-b">
                    <div class="card-header border-0">
                        <h3 class="card-title font-weight-bolder text-dark">Variations</h3>
                        <div class="card-toolbar">
                            <button type="button" @click="addVariantLine()" class="btn btn-primary btn-sm font-weight-bolder">Add variatation</button>
                        </div>
                    </div>
                    <div class="card-body pt-2">
                        <div>
                            <div id="variations-options-container">
                                <div v-for="(variant, index) in variations" :key="index" class="row">
                                    <div class="col-md-3" style="padding-left 0px !important;">
                                        <div class="form-group">
                                            <label>Option</label>
                                            <input type="text" v-model="variant.option" class="form-control" />
                                        </div>
                                    </div>
                                    <div class="col-md-3" style="padding-left 0px !important;">
                                        <div class="form-group">
                                            <label>Type</label>
                                            <select v-model="variant.type" class="variant-type form-control">
                                                <option value="4">Radio buttons</option>
                                                <option value="1">Dropdown list</option>
                                                <option value="2">Textual buttons</option>
                                                <option value="3">Color based buttons</option>
                                                <option value="5">Image based buttons</option>
                                                <option value="6">Upload image zone</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-5" style="padding-left 0px !important;">
                                        <div class="form-group">
                                            <label>Values</label>
                                            <vue-tags-input v-model="variant.tag" @tags-changed="newTags => { addVariantValue(variant, newTags) }" />
                                        </div>
                                    </div>
                                    <div class="col-md-1" style="display: flex; justify-content: center; align-items: center;">
                                        <div class="btn btn-danger" @click="removeVariantLine(index)">
                                            <svg
                                                xmlns="http://www.w3.org/2000/svg"
                                                width="17"
                                                height="17"
                                                viewBox="0 0 24 24"
                                                fill="none"
                                                stroke="currentColor"
                                                stroke-width="2"
                                                stroke-linecap="round"
                                                stroke-linejoin="round"
                                                class="feather feather-trash-2"
                                            >
                                                <polyline points="3 6 5 6 21 6"></polyline>
                                                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                                                <line x1="10" y1="11" x2="10" y2="17"></line>
                                                <line x1="14" y1="11" x2="14" y2="17"></line>
                                            </svg>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="variations-prices-container">
                                <div class="row">
                                    <table class="table table-bordered table-striped">
                                        <thead>
                                        <tr>
                                            <th>Image</th>
                                            <th>Variant</th>
                                            <th>Price</th>
                                            <th>SKU</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        <template v-for="(variant, i) in variations" :key="i">
                                            <tr v-for="(variantPrice, j) in variant.values" :key="j + '' + i">
                                                <td>
                                                    <img @click="chooseImage(variantPrice)" :src="variantPrice.image" style="width: 80px; height: 80px" alt="" />
                                                </td>
                                                <td><strong>@{{ variant.option }}:</strong> @{{ variantPrice.value }}</td>
                                                <td>
                                                    <input type="text" name="variantsPrices[]" v-model="variantPrice.price" class="form-control" placeholder="Price" />
                                                </td>
                                                <td>
                                                    <input type="text" name="variantsSkus[]" v-model="variantPrice.sku" class="form-control" placeholder="SKU" />
                                                </td>
                                                <input type="hidden" name="variantsOptions[]" v-model="variant.option" />
                                                <input type="hidden" name="variantsTypes[]" v-model="variant.type" />
                                                <input type="hidden" name="variantsImages[]" v-model="variantPrice.image" />
                                            </tr>
                                        </template>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Images modal -->
                <div class="modal" id="images-model" tabindex="-1">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title">Modal title</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                            </div>
                            <div class="modal-body">
                                <div class="row">
                                    <div v-for="(uploadedImage, index) in uploadedImages" :key="index" class="col-md-4 mb-3">
                                        <img
                                            @click="selectImage(uploadedImage)"
                                            :src="uploadedImage"
                                            :class="{'border border-3 border-success': selectedVariantPrice.image == uploadedImage}"
                                            class="img-fluid"
                                            alt=""
                                        >
                                    </div>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                                <button type="button" class="btn btn-primary">Save changes</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
        
        </div>
    </form>
         

    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js" integrity="sha384-+YQ4JLhjyBLPDQt//I+STsc9iw4uQqACwlvpslubQzn4u2UU2UFM80nGisd026JF" crossorigin="anonymous"></script>
    
    <script src="https://unpkg.com/filepond-plugin-image-preview/dist/filepond-plugin-image-preview.js"></script>
    <script src="https://unpkg.com/filepond/dist/filepond.js"></script>
    <script src="https://cdn.tiny.cloud/1/915blb2k8clpopckcckzolk5g8gnvs3ewtkrahwfo7alpqtm/tinymce/5/tinymce.min.js" referrerpolicy="origin"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.12"></script>
    <script src="https://unpkg.com/@johmun/vue-tags-input/dist/vue-tags-input.js"></script>
    <script>
        $.ajaxSetup({
            headers: {
                'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
            }
        });
        $('#category').on('change',function(e){
            console.log("function start");
            var id=$(this).val();
            console.log(id);
            var link = '{{url('')}}/admin/store/get/categore/'+id+'';
            console.log(link);
            var getcatagory = $.ajax({
                url:link,
                type:"GET",
                data: {
                    _token: $('meta[name="csrf-token"]').attr('content'),
                },
                dataType: "json",
                success:function (data) {
                    console.log("daa");
                    $('.subcategore').empty();
                    var categores=data.categores;
                    categores.forEach(categore => {
                        $('.subcategore').append('<option value="'+ categore.id+'">'+categore.name+' </option>');
                    });
                }
            });
        });
        FilePond.registerPlugin(
            FilePondPluginImagePreview
        );
        const inputElement = document.querySelector('input[name="images"]');
        const pond = FilePond.create( inputElement ,{
            imageResizeTargetWidth: 200,
            imageResizeTargetHeight: 200,
            styleLoadIndicatorPosition: 'center bottom',
            styleButtonRemoveItemPosition: 'center bottom'
        });
        FilePond.setOptions({
            server:{
                url:'/admin/store/products/image/uplode',
                headers:{
                    'X-CSRF-TOKEN' :'{{ csrf_token() }}'
                }
            }
        });
        // $("#myFormId").on('submit', function(e) {
        //     setImages();
        //     e.preventDefault();
        //     $.ajax({
        //         url:$(this).prop('action'),
        //         type:$(this).prop('method'),
        //         data: $(this).serialize(),
        //         dataType: "json",
        //         success:function (data) {
        //             var notify='<div class="alert alert-custom alert-success fade show" id="alert" role="alert"> <div class="alert-icon"><i class="flaticon2-checkmark"></i></div> <div class="alert-text"> Product successfully Added</div> <div class="alert-close"> <button type="button" class="close" data-dismiss="alert" aria-label="Close"> <span aria-hidden="true"><i class="ki ki-close"></i></span> </button> </div> </div>';
        //             $('.alert_container').append(notify);
        //             $('.alert_container').animate({right: '0px'});
        //         }
        //     }).done(function() {
        //         console.log('request was sent');
        //     });
        // });
        function setImages(){
            var inputs = $('.filepond--data input');
            // var images=[];
            var inputs_length = inputs.length;
            for(var x=0;x < inputs_length;x++){
                var value = inputs[x].setAttribute('name','images[]');
            }
        }
        function sendRequest(){
            setImages();
            document.getElementById('myFormId').submit();
        }
    </script>

    <script>
        tinymce.init({
            selector: '#mytextarea'
        });
        function uploadedImageList() {
            images = [];
            const tmpFolderPath = "{{ asset('storage/products/tmp/') }}/";
            var folders = $('input[name="images"]');
            var i = 0;
            var urls = $('.filepond--file-info-main').each(function () {
                images.push(tmpFolderPath + folders[i].value + '/' + $(this).text());
                i++;
            });
            return images;
        }
        let app = new Vue({
            el: '#vue-app',
            data: {
                uploadedImages: [],
                selectedImage: '',
                selectedVariantPrice: null,
                variations: [
                    {
                        option: '',
                        type: '',
                        tag: '',
                        values: []
                    }
                ]
            },
            methods: {
                addVariantLine() {
                    this.variations.push({
                        option: '',
                        type: '',
                        values: []
                    });
                },
                removeVariantLine(index) {
                    this.variations.splice(index, 1);
                },
                addVariantValue(variant, newValues) {
                    variant.values = newValues.map(value => ({image: 'https://via.placeholder.com/80', price: 0, sku: '', value: value.text}))
                },
                chooseImage(selectedVariantPrice) {
                    this.selectedVariantPrice = selectedVariantPrice;
                    this.uploadedImages = uploadedImageList();
                    $('#images-model').modal();
                },
                selectImage(selectedImage) {
                    this.selectedVariantPrice.image = selectedImage;
                }
            }
        });
       
    </script>

    </body>
</html>

